!function(){var e={base_url:"http://localhost:3000",hideModals:()=>{document.querySelectorAll(".is-active").forEach(e=>{e.classList.remove("is-active")})}};const t={handleAddCardForm:async d=>{d.preventDefault();const o=new FormData(d.target);o.set("position",1);const a=await fetch(e.base_url+"/cards",{method:"POST",body:o});if(200!==a.status)return void alert("Erreur serveur");const s=await a.json();t.makeCardInDOM(s)},makeCardInDOM:({id:d,name:o,list_id:a,color:s})=>{const r=document.getElementById("cardTemplate"),n=document.importNode(r.content,!0),i=n.getElementById("title");i.textContent=o,n.querySelector(".fa-pencil-alt").parentNode.addEventListener("click",()=>t.toggleModifyForm(d)),n.querySelector("form").addEventListener("submit",async o=>{o.preventDefault();const a=new FormData(o.target);200==(await fetch(`${e.base_url}/cards/${d}`,{method:"PATCH",body:a})).status&&(i.textContent=a.get("name")),t.toggleModifyForm(d)}),n.querySelector(".fa-trash-alt").parentNode.addEventListener("click",async()=>{200==(await fetch(`${e.base_url}/cards/${d}`,{method:"DELETE"})).status&&document.querySelector(`[data-card-id="${d}"]`).remove()});const l=n.querySelector(".box");l.setAttribute("data-card-id",d),l.style.backgroundColor=s,n.querySelector("[data-coloris]").addEventListener("click",()=>{Coloris({onChange:async t=>{const o=new FormData;o.set("color",t),200==(await fetch(`${e.base_url}/cards/${d}`,{method:"PATCH",body:o})).status&&(l.style.backgroundColor=t)}})}),document.querySelector(`[data-list-id="${a}"]`).querySelector(".list-container").prepend(n),e.hideModals()},showAddCardModal:e=>{document.getElementById("addCardModal").classList.add("is-active");const t=e.target.closest(".panel").getAttribute("data-list-id");document.getElementById("listIdInput").value=t},toggleModifyForm:e=>{const t=document.querySelector(`[data-card-id="${e}"]`),d=t.querySelector("#title"),o=t.querySelector("form");d.classList.toggle("is-hidden"),o.classList.toggle("is-hidden")}};var d=t;const o={getListsFromAPI:async()=>{const t=await fetch(e.base_url+"/lists");(await t.json()).forEach(e=>{o.makeListInDOM(e)})},handleAddListForm:async t=>{t.preventDefault();const d=new FormData(t.target);d.set("position",1);const a=await fetch(e.base_url+"/lists",{method:"POST",body:d});if(200!==a.status)return void alert("Erreur du serveur");const s=await a.json();o.makeListInDOM(s)},makeListInDOM:({id:t,name:a,cards:s})=>{const r=document.getElementById("listTemplate"),n=document.importNode(r.content,!0),i=n.getElementById("title");i.textContent=a,i.addEventListener("dblclick",()=>o.toggleModifyForm(t)),n.querySelector("form").addEventListener("submit",async d=>{d.preventDefault();const a=new FormData(d.target);200==(await fetch(`${e.base_url}/lists/${t}`,{method:"PATCH",body:a})).status&&(i.textContent=a.get("name")),o.toggleModifyForm(t)}),n.querySelector(".fa-trash-alt").parentNode.addEventListener("click",async()=>{window.confirm(`\xcates-vous s\xfbr de vouloir supprimer cette liste: ${i.textContent}.\nLa suppression de la liste est irr\xe9versible !`)&&200==(await fetch(`${e.base_url}/lists/${t}`,{method:"DELETE"})).status&&document.querySelector(`[data-list-id="${t}"]`).remove()}),n.querySelector(".panel").setAttribute("data-list-id",t),n.querySelector(".is-pulled-right").addEventListener("click",d.showAddCardModal),document.querySelector(".card-lists").prepend(n),s&&s.forEach(e=>{d.makeCardInDOM(e)}),e.hideModals()},showAddListModal:()=>{document.getElementById("addListModal").classList.add("is-active")},toggleModifyForm:e=>{const t=document.querySelector(`[data-list-id="${e}"]`),d=t.querySelector("#title"),o=t.querySelector("form");d.classList.toggle("is-hidden"),o.classList.toggle("is-hidden")}};var a=o;const s={init:()=>{s.addListenerToActions(),a.getListsFromAPI()},addListenerToActions:()=>{const e=document.getElementById("addListButton"),t=document.querySelectorAll(".close"),o=document.getElementById("listForm"),r=document.querySelectorAll(".is-pulled-right"),n=document.getElementById("cardForm");e.addEventListener("click",a.showAddListModal),t.forEach(e=>e.addEventListener("click",s.hideModals)),o.addEventListener("submit",a.handleAddListForm),r.forEach(e=>e.addEventListener("click",d.showAddCardModal)),n.addEventListener("submit",d.handleAddCardForm)}};document.addEventListener("DOMContentLoaded",s.init)}();